<include file="__THEME__/public_header" />

<style type="text/css">
    .center_left{
        border-radius: 4px;
        overflow:hidden;
        float: left;
    }
    .center_right{
        float: right;
    }
    .center_right_tit div .on{
        color:#00BED4;
    }
    .user-con-title a{
        width:auto;
        float: left;
    }
</style>
<!--centerbox end-->
<div class="content cbg" style="background-color:#f0f0f2;padding:30px 0;">
    <div class="wrap">
        <include file="../User/public/_left" />

        <div class="center_right">
            <div class="center_right_tit">
                <div class="user-con-title">
                    <h5>绑定银行卡</h5>
                </div>
            </div>

            <div class="center_right_con Manage_all" style="display:block;">
                <?php if($isEditCard):?>
                <div class="user-Release">
                    <form method="post" action="{:U('classroom/User/card')}" class="infobox">
                        <dl>
                            <dt><span>*</span>开户银行：</dt>
                            <dd>
                                <select class="inputcheckbox select" name="accounttype" style="width:392px ;padding-left:10px;">
                                    <option value="">-选择银行-</option>
                                    <?php foreach($banks as $bank):?>
                                    <option <?php echo $data['accounttype']==$bank?' selected="selected"':''?> value="{$bank}">{$bank}</option>
                                    <?php endforeach;?>
                                </select>
                            </dd>
                        </dl>
                        <dl>
                            <dt><span>*</span>开户省：</dt>
                            <dd style="width: 450px;">
                                <style>
                                    select{width: 118px;}
                                </style>
                                {:W('Area',array('curPro'=>$data['province'],'curCity'=>$data['city'],'area'=>$data['area'],'city_names'=>$data['location'],'tpl'=>'zyCardArea'))}
                            </dd>
                        </dl>
                        <dl>
                            <dt><span>*</span>开户分行地址：</dt>
                            <dd>
                                <textarea class="tex01" id="bankarea"  name="bankofdeposit">{$data['bankofdeposit']}</textarea>
                                <p >详细的分行地址/开户行，如不清楚，请咨询银行客服。</p>
                            </dd>
                        </dl>
                        <dl>
                            <dt><span>*</span>银行帐号：</dt>
                            <dd>
                                <input type="text" id ="bankcard" class="inp01" rel="银行帐号" name="account" value="{$data['account']}">
                                <p >请填写与您提供的银行账户持卡人姓名一致的储蓄卡帐号。</p>
                            </dd>
                        </dl>
                        <dl>
                            <dt><span>*</span>开户姓名：</dt>
                            <dd>
                                <input type="text" class="inp01" rel="开户姓名" id= "cardname"  name="accountmaster" value="{$data['accountmaster']}" style="color:#666">
                                <p >请填写与您提供的银行账户持卡人姓名开户姓名。</p>
                            </dd>
                        </dl>
                        <dl>
                            <dt><span>*</span>手 机：</dt>
                            <dd>
                                <input type="text" class="inp01" id="head_search" rel="手机" name="tel_num" value="{$data['tel_num']}" style="color:#666">
                                <p >请填写你的手机号码</p>
                            </dd>
                        </dl>
                        <dl>
                            <dd>
                                <a href="javascript:;" class="btn" type="button"  style="height: 40px;line-height: 40px;"onclick="saveCard(this)">提 交</a>
                            </dd>
                        </dl>
                    </form>

                    <style type="text/css">
                        .user-set-sz .label{ width:110px}
                        .user-set-sz li p{ left:115px}
                        .user-set-sz{ padding-left:130px}
                        .user-set-sz .user-submit{ width:332px;}
                    </style>
                </div>
                <?php else:?>
                <div class="cent_r_box pb40 clearfix">
                    <div class="box_block">
                        <table class="table_ye" cellpadding="0" cellspacing="1" bordercolor="#dddddd"border="1" width="100%">
                            <thead>
                            <tr><td width="16%">银行卡</td>
                                <td width="36%">卡号</td>
                                <td width="16%">持卡人姓名</td>
                                <td width="16%">联系方式</td>
                                <td width="16%">操作</td>
                            </tr></thead>
                            <tbody><tr>
                                <td><?php echo $data['accounttype']?></td>
                                <td><?php echo $data['account']?></td>
                                <td><?php echo $data['accountmaster']?></td>
                                <td><?php echo $data['tel_num']?></td>
                                <td><a href="{:U('classroom/User/card', array('edit'=>'yes'))}">修改</a></td>
                            </tr>
                            </tbody></table>
                    </div>
                </div>
                <?php endif;?>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

function saveCard(o){
	var form = $(o).parents('form');
	var val = form.find('select:first').children(':selected').val();
	if(!$.trim(val)){
		notes('请选择开户银行', 'failure');
		form.find('select:first').focus();
		return false;
	}
	var province = form.find('select#province').children(':selected').val();
	var city = form.find('select#city').children(':selected').val();
	if(province<=0||city<=0){
		notes('请选择开户省市', 'failure');
		return false;
	}
	
	var itxts = form.find('input:text');
	if(!$('#bankarea').val()){
		notes('请输入分行地址/开户行', 'failure');
        $('#bankarea').focus(); return false;
	}	if(!$('#cardname').val()){
		notes('请输入分行地址/开户行', 'failure');
        $('#cardname').focus(); return false;
	}
	if(!/^\d{16,19}$/.test($('#bankcard').val())){
		notes('请正确的银行帐号', 'failure');
        $('#bankcard').focus(); return false;
	}
	if(!/^1[3458][0-9]{9}$/.test($('#head_search').val())){
		notes('请输入正确的手机', 'failure');
        $('#head_search').focus(); return false;
	}
	$.post('{:U("classroom/User/card")}', form.serialize(), function(data){
		if(data.status){
			notes('保存成功', 'success');
			setTimeout(function(){
				window.location = '{:U("classroom/User/card")}';
			}, 2000);
		}else{
			notes('保存失败', 'failure');
		}
	}, 'json');
}

</script>

<include file="__THEME__/public_footer" />